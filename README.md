# Assertive.Me Telegram Bot

Telegram-бот для переформулирования токсичных сообщений в ассертивные варианты с использованием GPT-3.5 Turbo.

## Функциональность

- **Обработка пересланных сообщений**: Перешлите любое текстовое сообщение боту для переформулировки
- **Прямой ввод текста**: Отправьте текст напрямую боту
- **Генерация 3 ассертивных вариантов** с использованием OpenAI GPT-3.5 Turbo
- **Система обратной связи** с inline кнопками
- **Сбор метрик** использования в SQLite базе данных

## Установка и запуск

### 1. Клонирование и установка зависимостей

```bash
git clone <repository-url>
cd assertive-me-bot
python -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate  # Windows

pip install -r requirements_simple.txt
```

### 2. Настройка переменных окружения

Создайте файл `.env` со следующими переменными:

```
TELEGRAM_BOT_TOKEN=ваш_токен_от_BotFather
OPENAI_API_KEY=ваш_ключ_OpenAI
DATABASE_PATH=metrics.db
```

### 3. Запуск бота

```bash
python main_simple_stable.py
```

## Структура проекта

```
assertive-me-bot/
├── main_simple_stable.py              # Основной файл запуска
├── config.py            # Конфигурация и настройки
├── database.py          # Работа с SQLite базой данных
├── llm_service.py       # Интеграция с OpenAI API
├── message_handler.py   # Обработка сообщений Telegram
├── validators.py        # Валидация входящих сообщений
├── requirements_simple.txt     # Зависимости Python
├── .env                 # Переменные окружения
└── README.md           # Документация
```

## Деплой на Render.com

1. Создайте аккаунт на [render.com](https://render.com)
2. Подключите ваш GitHub репозиторий
3. Создайте новый Web Service
4. Установите переменные окружения в настройках Render
5. Деплой произойдет автоматически

## Команды бота

- `/start` - Приветственное сообщение и инструкции

## Использование

1. Запустите бота командой `/start`
2. Перешлите любое текстовое сообщение или напишите текст напрямую
3. Получите 3 ассертивных варианта переформулировки
4. Выберите подходящий вариант или укажите причину отказа

## Метрики

Бот собирает следующие метрики в SQLite базу данных:
- Количество уникальных пользователей
- Статистика по типам сообщений (пересланные/прямые)
- Топ чатов-источников пересылок
- Выбор пользователей (какие варианты популярнее)
- Причины отказа от всех вариантов

## Технические детали

- **LLM**: OpenAI GPT-3.5 Turbo
- **База данных**: SQLite
- **Фреймворк**: python-telegram-bot v20.7
- **Хостинг**: Render.com (рекомендуется)

## Лимиты и ограничения

- Минимальная длина сообщения: 10 символов
- Максимальная длина сообщения: 4000 символов
- В MVP нет ограничений на количество запросов

## Поддержка

При возникновении проблем проверьте:
1. Правильность токенов в `.env` файле
2. Наличие средств на балансе OpenAI
3. Правильность настройки бота через @BotFather
